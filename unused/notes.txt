
export AWS_DEFAULT_REGION="eu-west-1"
export TF_VAR_deployed_at=$(date +%s)



  Mapping:
    Type: 'AWS::ApiGateway::BasePathMapping'
    Properties:
      DomainName: !Ref CustomDomainName
      RestApiId: !Ref Api

### DNS
  APIDNS:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      AliasTarget:
        DNSName:
          Fn::GetAtt:
          - CustomDomainName
          - RegionalDomainName
      #  HostedZoneId:
      HostedZoneName: !Sub
          - ${Domain}.
          - Domain: !Ref RDomainName
      Name: !Sub
          - ${Domain}
          - Domain: !Ref DomainName
      Type: A

      (aws) FL561:cloudformation bama$ aws cloudformation describe-stacks --output text
      STACKS	2019-03-27T08:29:44.727Z	AWS CloudFormation sample template that contains a single Lambda function behind an API Gateway	False		arn:aws:cloudformation:eu-west-1:831363121910:stack/results-lambda/798781f0-506a-11e9-a3ab-0a00435bc49c	results-lambda	CREATE_COMPLETE
      CAPABILITIES	CAPABILITY_IAM
      DRIFTINFORMATION	NOT_CHECKED
      OUTPUTS	Root URL of the API gateway	RootUrl	https://qynyg9q1o2.execute-api.eu-west-1.amazonaws.com
      STACKS	2019-03-27T07:53:29.731Z	Cognito Stack	False		arn:aws:cloudformation:eu-west-1:831363121910:stack/results-cognito/692174b0-5065-11e9-9698-0ac6bcaf6240	results-cognito	CREATE_COMPLETE
      CAPABILITIES	CAPABILITY_IAM
      DRIFTINFORMATION	NOT_CHECKED
      OUTPUTS	UserPoolClient::Id	UserPoolClientId	6cjqnmq08fosuvde6tnvtbfsqj
      OUTPUTS	UserPool::Id	UserPoolId	eu-west-1_OTyJTR6aE
      OUTPUTS	IdentityPool::Id	IdentityPoolId	eu-west-1:c3c27f0a-f2f1-44d2-b41e-1437427d3f51
      OUTPUTS	CognitoAuthorizedRole:Arn	CognitoAuthorizedRoleArn	arn:aws:iam::831363121910:role/results-cognito-CognitoAuthorizedRole-1H4EC86059PIK
      STACKS	2019-03-26T23:02:55.047Z		False	2019-03-26T23:19:16.861Z	arn:aws:cloudformation:eu-west-1:831363121910:stack/api/4a2db7c0-501b-11e9-b4af-0a678be70e04	api	UPDATE_ROLLBACK_COMPLETE
      CAPABILITIES	CAPABILITY_IAM
      DRIFTINFORMATION	NOT_CHECKED
      PARAMETERS	DomainName	api.devopssquad.com
      PARAMETERS	StageName	dev
      PARAMETERS	RDomainName	devopssquad.com
      PARAMETERS	LambdaCodeBucket	serverless-aws-automation-comparison
      PARAMETERS	LambdaCodePath	process_request.zip
      PARAMETERS	ResultsBucket	devopssquad-results
      PARAMETERS	Certificate	arn:aws:acm:eu-west-1:831363121910:certificate/642953bd-7ac9-4249-b5e2-249ceb571e2c
      STACKS	2019-03-26T21:16:53.579Z		False		arn:aws:cloudformation:eu-west-1:831363121910:stack/website/7a733130-500c-11e9-81c5-0637a63b4e60	website	CREATE_COMPLETE
      DRIFTINFORMATION	NOT_CHECKED
      OUTPUTS	URL for website hosted on S3	WebsiteURL	http://hello.devopssquad.com.s3-website-eu-west-1.amazonaws.com
      PARAMETERS	DomainName	hello.devopssquad.com
      PARAMETERS	RDomainName	devopssquad.com
      PARAMETERS	ResultsBucket	devopssquad-results

https://github.com/aws-samples/amazon-quicksight-embedding-sample
      (aws) FL561:cloudformation bama$ aws cognito-idp admin-initiate-auth --user-pool-id  eu-west-1_OTyJTR6aE --client-id 6cjqnmq08fosuvde6tnvtbfsqj --auth-flow ADMIN_NO_SRP_AUTH --auth-parameters USERNAME=guest,PASSWORD='Guest!123'
      NEW_PASSWORD_REQUIRED	gOolxzNOiu3nGDq5XtWE05W4MYhURduzzMow36lBwDiQM1CFrTBghVeWtK7a-EIUTaWQjLnRd-WZtMu1JIVLzY3lnaqI2ulFBK-Vz5x5Vc2ghqRYWbFh3W9ITm4aVBVJz2rCq3_5loxegc6He4kKDdos5TmbEz8IU2dKoOWDkJRsqMG1GTr5mapTNxVq8KyIQ8Gz5Z4d8zdAKIytkS_iUK8GAiZoBBrTYqLLra2MC8Di0fmo7sWtvG_rKfPLpyyTK79CAmTioYj8Yo6ZD02OCzDihIIA7eek7rQSA8ghwO9SSOIAJlkZUaQ_oswMgJtFaekDRNE-wSNXbB4mTFEyxI6Q5QGnN9hViElHCxDjyavo6WEaeYANfwacvgOdw-Sr5Qla2YbeMH2U1iT142CC7lP-c0uMch3mjfL4nHRDHaAi9KMMYhwdJ-QhGF7iqRtKkueGm6dVzKQGAImijBNy4IUGbL3SFshYLXTQCigc7SnWnOQK_Zjua6hGpDMYvSXVSKNTv5rZh8wxnxtqc8dRqjCxoXG9jQ5RMZ4ARHUQLCsjo3QMsNv3egDxplGGfIV9kiKcKrzyymqisaLbJcRMzOxx7Bu1btNh0w8jDUk4DWCHrY30jPqv3eD3W4S6PtwC2uEyZwiLFEns5AhAQNys-lXxZTfpOaYnVtH7rSYoYcUD0h-zEy87tUfeZfyQyW_uE1bMT-5wZZsD60SHQvixnUUuWZyyS0M0bmDOjE1wTdOd01mpwqmM0xzDwrk0ICWgu4icbYHwOp3MjabOEOYzNI6L48tx28w_j0qRRKETDwbvF1vSkmpMVYxIEi_13J-OrFDUOw
      CHALLENGEPARAMETERS	guest	["userAttributes.name"]	{"email_verified":"true","name":"","email":"hello@brunoamaro.com"}
      (aws) FL561:cloudformation bama$ KEY="gOolxzNOiu3nGDq5XtWE05W4MYhURduzzMow36lBwDiQM1CFrTBghVeWtK7a-EIUTaWQjLnRd-WZtMu1JIVLzY3lnaqI2ulFBK-Vz5x5Vc2ghqRYWbFh3W9ITm4aVBVJz2rCq3_5loxegc6He4kKDdos5TmbEz8IU2dKoOWDkJRsqMG1GTr5mapTNxVq8KyIQ8Gz5Z4d8zdAKIytkS_iUK8GAiZoBBrTYqLLra2MC8Di0fmo7sWtvG_rKfPLpyyTK79CAmTioYj8Yo6ZD02OCzDihIIA7eek7rQSA8ghwO9SSOIAJlkZUaQ_oswMgJtFaekDRNE-wSNXbB4mTFEyxI6Q5QGnN9hViElHCxDjyavo6WEaeYANfwacvgOdw-Sr5Qla2YbeMH2U1iT142CC7lP-c0uMch3mjfL4nHRDHaAi9KMMYhwdJ-QhGF7iqRtKkueGm6dVzKQGAImijBNy4IUGbL3SFshYLXTQCigc7SnWnOQK_Zjua6hGpDMYvSXVSKNTv5rZh8wxnxtqc8dRqjCxoXG9jQ5RMZ4ARHUQLCsjo3QMsNv3egDxplGGfIV9kiKcKrzyymqisaLbJcRMzOxx7Bu1btNh0w8jDUk4DWCHrY30jPqv3eD3W4S6PtwC2uEyZwiLFEns5AhAQNys-lXxZTfpOaYnVtH7rSYoYcUD0h-zEy87tUfeZfyQyW_uE1bMT-5wZZsD60SHQvixnUUuWZyyS0M0bmDOjE1wTdOd01mpwqmM0xzDwrk0ICWgu4icbYHwOp3MjabOEOYzNI6L48tx28w_j0qRRKETDwbvF1vSkmpMVYxIEi_13J-OrFDUOw"
      (aws) FL561:cloudformation bama$  aws cognito-idp admin-respond-to-auth-challenge --user-pool-id eu-west-1_OTyJTR6aE --client-id 6cjqnmq08fosuvde6tnvtbfsqj --challenge-name NEW_PASSWORD_REQUIRED --challenge-responses NEW_PASSWORD=Guest#123,USERNAME=guest,userAttributes.name=guest --session $KEY
      AUTHENTICATIONRESULT	eyJraWQiOiJTajdoSFlBczZuUWJLbzlCM1ZVaDlCWVVTTlJTVUZjZk05eDFFN0NDVnBnPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiI5M2Y1ZGQ1Yi0xNjhiLTQ0MGItOTMyYS00YTU4MTllNjJkOTUiLCJldmVudF9pZCI6IjNmNTI2MzBkLTUwNmEtMTFlOS1iMDA0LTUxODI1ODlkZDZhMyIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4iLCJhdXRoX3RpbWUiOjE1NTM2NzUyODcsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbVwvZXUtd2VzdC0xX09UeUpUUjZhRSIsImV4cCI6MTU1MzY3ODg4NywiaWF0IjoxNTUzNjc1Mjg3LCJqdGkiOiJhZDkxZDVhNC0xN2Q0LTRjNDgtYTczOS1jNTc0ZmYyNDBhNmYiLCJjbGllbnRfaWQiOiI2Y2pxbm1xMDhmb3N1dmRlNnRudnRiZnNxaiIsInVzZXJuYW1lIjoiZ3Vlc3QifQ.YkUW61gx5pxzDVtp6edts9w42LgH7Y2JS6DLN1LlOs7ER2_aBkskGHh2MdY6O2WgrBeEeE7MIFLNJjupIEfYiv2gEM7nU5FPZa90xG6zXgdtHcIndfP1wCu9jyBoLqeolC-AciKdq4g5nvPNeu9OXvMYPauAQRoZsSuXlPIKJYisAoDh28NBAolqZiLjsEf5hk-O76bwQZoxB6wF2Yrzn558QrisU9Wbn8rYred5VWwvXbXd5qkcREayibEG0d259clieHBLi1wTu87akBjmUeqlRIvgjgGsh1dv-d0tDQyLhl1XyHZz3ooxPVU2zfInA7wi7ZnH4zkBAUgRCj-TfA	3600	eyJraWQiOiJHM05aSFdKM2dzbVpEU3I5S0FcL0hKM25HWng1UnI3ZVVhejByR09uaDRYOD0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiI5M2Y1ZGQ1Yi0xNjhiLTQ0MGItOTMyYS00YTU4MTllNjJkOTUiLCJhdWQiOiI2Y2pxbm1xMDhmb3N1dmRlNnRudnRiZnNxaiIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjNmNTI2MzBkLTUwNmEtMTFlOS1iMDA0LTUxODI1ODlkZDZhMyIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNTUzNjc1Mjg3LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9PVHlKVFI2YUUiLCJuYW1lIjoiZ3Vlc3QiLCJjb2duaXRvOnVzZXJuYW1lIjoiZ3Vlc3QiLCJleHAiOjE1NTM2Nzg4ODcsImlhdCI6MTU1MzY3NTI4NywiZW1haWwiOiJoZWxsb0BicnVub2FtYXJvLmNvbSJ9.fpH4h4LNqW95QRPddV6g9B0t_9Nv-6EbmdKKYyijeACMv2QAszJaIG6RKXCxlk492GkG94IgmdjytF4Q6EbI0Sa_s49fIuFypHoXUkROBwTtyU55hVA_gj0_2Hw7QAsC9AOUHwJxy7S0uW9LY0oNMUoTZ2CVZNfrRS2mrAkHg6i-RNM6quAPB4MHZRYg-1-70gkuGUw_tFWUYqMRiFddRhoYzDgeFgtxmQxJeQVfdxhwEuaJ9fG27Gn-ZvO4G6zCpDZ2hfAn8ZmMq76jZHeDIK9RHUyWqEGbua7zjsbCIZiCTSD8b9JAkQ5ZvQLzmguxl7wF1R8wgryT1rlcFE2yeQ	eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ.SkgzVnmJrcmDZRcPb87kNk__vQhBpuo4GxbZSse9wpRX1laR5M_U9Nicbdr1ddVRXaDO2auyVqOkCaTv4axxPElZVRGvGqcE9fO_PuLgW308JLdyUZjkWhPoPJM6gpWldRtbMwaNttPjy3sOwKeomCzb_n_Vj8Bt25e3iO2K3HKfqBjWb8CIJx_5SXnZU7hHw0Z5MXVOMPvo4m8PU_RhiKjtcysnV4FiI72diwoHWwMQumt8QoIJooaotQm8FtxcZpFyiI54N4zApV_Cd_Mm6tx42UsLwXAMmRtctkYu2sPkhsycgB-QCKmddjDhOe99MslEootXULrnx9l1CyfZoQ.1L88lMj-f4TnM1Xn.HVCFJq8mfEnT7XgdOPmYPEVDdvF5n6EWZPcjgrLKqBtHS8EGRpdljNB-U7MdAOZP9WOTyVXJeP3GcrnqyC0nMB3arFL9t9dRg54GA1gvLAkVT5bDP_tIbMPbDSTMgbKF0gDYxxWKi4aq0waEaLGSSE6LdppY1N9-eZvcm-cunM-r5gBAW7LdVXE43puKlKad-LI5Cu97JyPWB3YyuVZ3H_2vRsNGY4ufq1SCg0oX83YkfZuLxiElfpynCjomK_Svn5v6rqRlLhhsf-5a2QhKu6rxnyQzu3lnff1DW5pRS6ND47q5Ly_-M9Eov7sHHp7oVs0vtG26-pXCqcnMpfFqNGmyW02o4wWnnvbbvdgx6jMy68xMxz_VG9HOND1vz5vE6UW8ERmhrQctAT1ZTs-yRtld9ijszxzk6Zk14NRJR0OguTWHKfsP-GKtEo5MvN6hTJl3XBItta12ZhTc3oijm647av0ANWHUnAvedWMwUQOt-YqL4h-X2h2RrPmELY4WVK43STP53BrB8g4Vth-jwhvLhnhFtHSOQuOB0WmLHDFdXvvAojf7qluvNGP9qSzWtthPu0NwSJEurVwQLLraOxTz7mxlIWFymt5qvdsCjHmESky-xYfPO702T4ZaAoHMAKYaTGznz637RVaOAcYt5ayaMHifIwSLHH0Gvi-Hy0Z07YpFXJlvpAwllWIu80JGOhBYnCuC3sAa_EeIMcnlynJ8hUZtmNhnNIt3EalVPAN1irNwI0millvuViGLJfvjm5551xWkqnqxKfDGBMl8PT3smnJz9OQUNSI7wMGj9Ydteu4qll6SBrRSiHw9NSSqo4K6W8YEFhr4QI4wCl_Mb-TAiAqccU14kxnqF6yEek8q-DWJy19wwN81P3OthP0AotfLJR2sBEXf8X7gLRI7cbWJp961DChzZFZbuBLTdl7__f_ihXsA7c8sAypjP6iPAZp4IYpifAnWvsAH2VUG_tqoepsNNb9kOiRCdVQ7fdLM4kFBGB7AiQcJR3LhE0kqo6FvR9IoxjUfpCjRzrySAU2zL0GPx173pGc6rOgeNPqu5gpCBFtFzJGqx4k7s-5FTQigyZqsQduVYdXhxAwz8l2DMGw5h155Pvy95CFH9pzpcAhClhm-O75AMsRu2uF9IAsex-b1oXHFeSWaX29KI-zEbxCnpRYp3Gya7PGKT_QMFECk7_xrcWTeBKadamOzYz6Bajwp5bEgtaIZs9Yc4ILGPRtSXuyJTXKMUcKnZ3RLZx2kBAQPCt22pT_zYueyhxA.0ZmCnnstg8-Fc_DeV0k_0Q	Bearer

aws cognito-idp admin-confirm-sign-up --user-pool-id  eu-west-1_OTyJTR6aE --username guest


username=guest&password=Guest#123&dashboardId=7f3bc663-5745-457f-a163-063ab159a4d7



https://d2mv3gppigwyir.cloudfront.net/result.html
